**Pattern**: Identifying sequences or patterns in ordered data.

**Decomposition Strategy**:

1. Order data chronologically
2. Compare adjacent or nearby records
3. Define pattern recognition criteria
4. Group and aggregate matching patterns

**Example**: "Identify trading patterns in stock price movements."

```SQL
WITH price_movements AS (
    SELECT
        stock_id,
        price_date,
        price,
        LAG(price) OVER (PARTITION BY stock_id ORDER BY price_date) AS prev_price,
        CASE
            WHEN price > LAG(price) OVER (PARTITION BY stock_id ORDER BY price_date) THEN 'UP'
            WHEN price < LAG(price) OVER (PARTITION BY stock_id ORDER BY price_date) THEN 'DOWN'
            ELSE 'FLAT'
        END AS movement
    FROM stock_prices
),

movement_patterns AS (
    SELECT
        stock_id,
        price_date,
        movement,
        LAG(movement, 1) OVER (PARTITION BY stock_id ORDER BY price_date) AS prev_1,
        LAG(movement, 2) OVER (PARTITION BY stock_id ORDER BY price_date) AS prev_2
    FROM price_movements
)

-- Find "head and shoulders" pattern (DOWN, UP, DOWN, UP, DOWN)
SELECT
    stock_id,
    price_date AS pattern_end_date
FROM movement_patterns
WHERE
    prev_2 = 'DOWN' AND
    prev_1 = 'UP' AND
    movement = 'DOWN' AND
    EXISTS (
        SELECT 1
        FROM movement_patterns mp2
        WHERE mp2.stock_id = movement_patterns.stock_id
        AND mp2.price_date < movement_patterns.price_date
        AND mp2.price_date > movement_patterns.price_date - INTERVAL '2 days'
        AND mp2.movement = 'UP'
        AND EXISTS (
            SELECT 1
            FROM movement_patterns mp3
            WHERE mp3.stock_id = mp2.stock_id
            AND mp3.price_date < mp2.price_date
            AND mp3.price_date > mp2.price_date - INTERVAL '2 days'
            AND mp3.movement = 'DOWN'
        )
    );
```
