**Pattern**: Identifying initial or final values within groups.

**Decomposition Strategy**:

1. Define groups and ordering criteria
2. Use window functions FIRST_VALUE() or LAST_VALUE()
3. Ensure proper window frame definition

**Example**: "Find each customer's first and last order date."

```SQL
WITH customer_orders AS (
    SELECT
        customer_id,
        FIRST_VALUE(order_date) OVER (
            PARTITION BY customer_id
            ORDER BY order_date
            ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
        ) AS first_order,
        LAST_VALUE(order_date) OVER (
            PARTITION BY customer_id
            ORDER BY order_date
            ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
        ) AS last_order
    FROM orders
)
SELECT DISTINCT customer_id, first_order, last_order
FROM customer_orders;
```
