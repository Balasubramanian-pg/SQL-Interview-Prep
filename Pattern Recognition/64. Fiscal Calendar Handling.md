**Pattern**: Working with non-standard calendar periods.

**Decomposition Strategy**:

1. Define fiscal period boundaries
2. Create mapping between standard and fiscal dates
3. Implement fiscal date arithmetic
4. Calculate aggregates by fiscal periods

**Example**: "Calculate sales by fiscal quarter where fiscal year starts February 1."

```SQL
WITH fiscal_periods AS (
    SELECT
        sale_date,
        amount,
        -- Calculate fiscal year (if Feb 1 start date)
        CASE
            WHEN EXTRACT(MONTH FROM sale_date) >= 2 THEN EXTRACT(YEAR FROM sale_date)
            ELSE EXTRACT(YEAR FROM sale_date) - 1
        END AS fiscal_year,
        -- Calculate fiscal quarter
        CASE
            WHEN EXTRACT(MONTH FROM sale_date) BETWEEN 2 AND 4 THEN 1
            WHEN EXTRACT(MONTH FROM sale_date) BETWEEN 5 AND 7 THEN 2
            WHEN EXTRACT(MONTH FROM sale_date) BETWEEN 8 AND 10 THEN 3
            ELSE 4
        END AS fiscal_quarter,
        -- Calculate fiscal month
        (EXTRACT(MONTH FROM sale_date) - 2 + 12) % 12 + 1 AS fiscal_month
    FROM sales
)

SELECT
    fiscal_year,
    fiscal_quarter,
    'Q' || fiscal_quarter || ' FY' || fiscal_year AS fiscal_period,
    SUM(amount) AS total_sales
FROM fiscal_periods
GROUP BY fiscal_year, fiscal_quarter
ORDER BY fiscal_year, fiscal_quarter;

-- Compare to previous fiscal year
WITH fiscal_sales AS (
    SELECT
        fiscal_year,
        fiscal_quarter,
        SUM(amount) AS quarterly_sales
    FROM fiscal_periods
    GROUP BY fiscal_year, fiscal_quarter
)

SELECT
    current.fiscal_year,
    current.fiscal_quarter,
    current.quarterly_sales AS current_sales,
    prev.quarterly_sales AS previous_year_sales,
    (current.quarterly_sales - prev.quarterly_sales) / prev.quarterly_sales * 100 AS growth_percentage
FROM fiscal_sales current
LEFT JOIN fiscal_sales prev
    ON current.fiscal_quarter = prev.fiscal_quarter
    AND current.fiscal_year = prev.fiscal_year + 1
ORDER BY current.fiscal_year, current.fiscal_quarter;
```