**Pattern**: Tracking historical changes in dimension tables.

**Decomposition Strategy**:

1. Identify SCD type (Type 1, 2, or 3)
2. Define strategy for handling changes
3. Track validity periods for historical records
4. Join with appropriate time constraints

**Example**: "Implement SCD Type 2 for customer address changes."

```SQL
-- Update existing record and create new one
INSERT INTO customer_dimensions (
    customer_id,
    address,
    city,
    state,
    postal_code,
    valid_from,
    valid_to,
    is_current
)
SELECT
    customer_id,
    NEW.address,
    NEW.city,
    NEW.state,
    NEW.postal_code,
    CURRENT_TIMESTAMP,
    NULL,
    true
FROM new_customer_data NEW;

-- Mark previous record as no longer current
UPDATE customer_dimensions
SET
    valid_to = CURRENT_TIMESTAMP - INTERVAL '1 second',
    is_current = false
WHERE
    customer_id = NEW.customer_id AND
    is_current = true;

-- Query to get customer details as of a specific date
SELECT
    customer_id,
    address,
    city,
    state,
    postal_code
FROM customer_dimensions
WHERE
    customer_id = 123 AND
    '2023-06-15' BETWEEN valid_from AND COALESCE(valid_to, '9999-12-31');
```
