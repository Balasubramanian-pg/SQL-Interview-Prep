**Pattern**: Calculating statistics over a shifting time window.

**Decomposition Strategy**:

1. Define the window size (e.g., 7 days, 30 days)
2. Order data chronologically
3. Apply window functions with appropriate frame
4. Calculate desired statistics

**Example**: "Calculate 7-day rolling average, min, and max for daily sales."

```SQL
SELECT
    sale_date,
    daily_total,
    AVG(daily_total) OVER (
        ORDER BY sale_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7day_avg,
    MIN(daily_total) OVER (
        ORDER BY sale_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7day_min,
    MAX(daily_total) OVER (
        ORDER BY sale_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS rolling_7day_max
FROM daily_sales
ORDER BY sale_date;
```
