**Pattern**: Identifying and quantifying data quality issues.

**Decomposition Strategy**:

1. Define data quality dimensions (completeness, accuracy, etc.)
2. Create metrics for each dimension
3. Set thresholds for acceptable quality
4. Flag problematic data areas

**Example**: "Assess data quality across customer records."

```SQL
WITH completeness AS (
    SELECT
        COUNT(*) AS total_records,
        SUM(CASE WHEN email IS NULL THEN 1 ELSE 0 END) AS missing_email,
        SUM(CASE WHEN phone IS NULL THEN 1 ELSE 0 END) AS missing_phone,
        SUM(CASE WHEN address IS NULL THEN 1 ELSE 0 END) AS missing_address
    FROM customers
),

format_validity AS (
    SELECT
        SUM(CASE WHEN email NOT LIKE '%@%.%' THEN 1 ELSE 0 END) AS invalid_email_format,
        SUM(CASE WHEN phone NOT REGEXP '^[0-9]{10}$' THEN 1 ELSE 0 END) AS invalid_phone_format,
        SUM(CASE WHEN postal_code NOT REGEXP '^[0-9]{5}(-[0-9]{4})?$' THEN 1 ELSE 0 END) AS invalid_postal_format
    FROM customers
),

duplication AS (
    SELECT
        COUNT(*) - COUNT(DISTINCT email) AS duplicate_emails,
        COUNT(*) - COUNT(DISTINCT phone) AS duplicate_phones
    FROM customers
    WHERE email IS NOT NULL AND phone IS NOT NULL
)

SELECT
    c.total_records,
    c.missing_email * 100.0 / c.total_records AS pct_missing_email,
    c.missing_phone * 100.0 / c.total_records AS pct_missing_phone,
    c.missing_address * 100.0 / c.total_records AS pct_missing_address,
    f.invalid_email_format * 100.0 / (c.total_records - c.missing_email) AS pct_invalid_email,
    f.invalid_phone_format * 100.0 / (c.total_records - c.missing_phone) AS pct_invalid_phone,
    d.duplicate_emails * 100.0 / (c.total_records - c.missing_email) AS pct_duplicate_email,
    d.duplicate_phones * 100.0 / (c.total_records - c.missing_phone) AS pct_duplicate_phone
FROM completeness c
CROSS JOIN format_validity f
CROSS JOIN duplication d;
```
