**Pattern**: Finding the middle value in an ordered dataset.

**Decomposition Strategy**:

1. Rank values in ascending order
2. Calculate total count of records
3. Filter for records at the middle position(s)

**Example**: "Find the median salary across all departments."

```SQL
WITH ranked AS (
    SELECT
        salary,
        ROW_NUMBER() OVER (ORDER BY salary) AS row_num,
        COUNT(*) OVER () AS total_count
    FROM employees
)
SELECT AVG(salary) AS median
FROM ranked
WHERE row_num BETWEEN total_count/2 AND total_count/2 + 1;
```