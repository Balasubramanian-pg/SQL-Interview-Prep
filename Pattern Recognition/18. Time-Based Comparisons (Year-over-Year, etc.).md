**Pattern**: Comparing metrics across equivalent time periods.

**Decomposition Strategy**:

1. Extract comparable time components (same month different years)
2. Self-join with time offset conditions
3. Calculate differences or growth percentages

**Example**: "Calculate year-over-year sales growth by month."

```SQL
WITH monthly_sales AS (
    SELECT
        EXTRACT(YEAR FROM sale_date) AS year,
        EXTRACT(MONTH FROM sale_date) AS month,
        SUM(amount) AS total_sales
    FROM sales
    GROUP BY year, month
)
SELECT
    curr.year,
    curr.month,
    curr.total_sales AS current_sales,
    prev.total_sales AS previous_sales,
    (curr.total_sales - prev.total_sales) / prev.total_sales * 100 AS growth_percent
FROM monthly_sales curr
LEFT JOIN monthly_sales prev
    ON curr.month = prev.month
    AND curr.year = prev.year + 1
WHERE prev.total_sales IS NOT NULL
ORDER BY curr.year, curr.month;
```