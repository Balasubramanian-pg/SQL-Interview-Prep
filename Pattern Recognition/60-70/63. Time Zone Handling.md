**Pattern**: Managing data across different time zones.

**Decomposition Strategy**:

1. Store timestamps in a standard time zone (UTC)
2. Convert to appropriate display time zones
3. Handle daylight saving time transitions
4. Perform time-based calculations across zones

**Example**: "Analyze customer activity across different time zones."

```SQL
-- Convert to user's local time zone
SELECT
    user_id,
    event_timestamp AT TIME ZONE 'UTC' AS utc_timestamp,
    event_timestamp AT TIME ZONE user_timezone AS local_timestamp,
    EXTRACT(HOUR FROM event_timestamp AT TIME ZONE user_timezone) AS local_hour
FROM user_events
JOIN users ON user_events.user_id = users.id;

-- Find peak activity hours by user's local time
SELECT
    EXTRACT(HOUR FROM event_timestamp AT TIME ZONE user_timezone) AS local_hour,
    COUNT(*) AS event_count
FROM user_events
JOIN users ON user_events.user_id = users.id
GROUP BY local_hour
ORDER BY event_count DESC;

-- Compare activity across time zones
WITH local_hours AS (
    SELECT
        user_timezone,
        EXTRACT(HOUR FROM event_timestamp AT TIME ZONE user_timezone) AS local_hour,
        COUNT(*) AS event_count
    FROM user_events
    JOIN users ON user_events.user_id = users.id
    GROUP BY user_timezone, local_hour
)

SELECT
    user_timezone,
    local_hour,
    event_count,
    event_count * 100.0 / SUM(event_count) OVER (PARTITION BY user_timezone) AS pct_of_timezone_activity
FROM local_hours
ORDER BY user_timezone, local_hour;
```
