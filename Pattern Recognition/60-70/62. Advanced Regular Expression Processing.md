**Pattern**: Complex text pattern matching and extraction.

**Decomposition Strategy**:

1. Define regex patterns for target text
2. Extract matched components
3. Apply transformations to extracted parts
4. Handle edge cases and validation

**Example**: "Extract structured data from log entry text."

```SQL
-- PostgreSQL regex
SELECT
    log_id,
    log_entry,
    -- Extract timestamp pattern
    SUBSTRING(log_entry FROM '^(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})') AS timestamp,
    -- Extract log level
    SUBSTRING(log_entry FROM '\[(DEBUG|INFO|WARNING|ERROR|CRITICAL)\]') AS log_level,
    -- Extract IP address (if present)
    SUBSTRING(log_entry FROM '(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})') AS ip_address,
    -- Extract user ID pattern (UID:xxxxxx)
    SUBSTRING(log_entry FROM 'UID:([A-Za-z0-9]+)') AS user_id,
    -- Extract message after log level tag
    SUBSTRING(log_entry FROM '\[(DEBUG|INFO|WARNING|ERROR|CRITICAL)\]\s+(.*)$') AS message
FROM application_logs;

-- Advanced validation and cleaning
SELECT
    email,
    -- Check if email has valid format
    email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$' AS is_valid_email,
    -- Extract domain
    SUBSTRING(email FROM '@([^@]+)$') AS domain,
    -- Sanitize inputs (remove potentially malicious patterns)
    REGEXP_REPLACE(user_input, '<script.*?>.*?</script>', '', 'gi') AS sanitized_input
FROM user_data;
```
