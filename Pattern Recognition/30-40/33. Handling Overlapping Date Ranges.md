**Pattern**: Managing events with start and end dates that might overlap.

**Decomposition Strategy**:

1. Identify all possible date boundaries
2. Count entries/exits at each boundary
3. Calculate running sum to find overlap count
4. Group consecutive dates with same overlap count

**Example**: "Find periods when more than 3 employees were on vacation simultaneously."

```SQL
WITH date_boundaries AS (
    -- Get all unique start and end dates
    SELECT vacation_start AS date, 1 AS change FROM employee_vacations
    UNION ALL
    SELECT vacation_end + INTERVAL '1 day', -1 FROM employee_vacations
),

daily_counts AS (
    -- Calculate running sum of overlapping vacations
    SELECT
        date,
        SUM(change) OVER (ORDER BY date) AS overlap_count
    FROM date_boundaries
),

consecutive_periods AS (
    -- Group consecutive dates with same count
    SELECT
        date,
        overlap_count,
        SUM(CASE
            WHEN LAG(overlap_count) OVER (ORDER BY date) = overlap_count THEN 0
            ELSE 1
        END) OVER (ORDER BY date) AS period_id
    FROM daily_counts
)

SELECT
    MIN(date) AS period_start,
    MAX(date) - INTERVAL '1 day' AS period_end,
    overlap_count
FROM consecutive_periods
WHERE overlap_count > 3
GROUP BY period_id, overlap_count
ORDER BY period_start;
```
