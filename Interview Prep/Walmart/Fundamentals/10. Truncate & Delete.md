# 10. *What does `TRUNCATE` do differently than `DELETE`?*
    (Rollback, logging, identity reset differences.)

*   **Operation Type**
> [!IMPORTANT]
> TRUNCATE is a DDL (Data Definition Language) operation.
> DELETE is a DML (Data Manipulation Language) operation.

*   **Speed & Performance**
> [!TIP]
> TRUNCATE is significantly faster than DELETE for removing all rows.
*   TRUNCATE deallocates entire data pages in one operation.
*   DELETE removes rows one at a time and logs each row deletion.
*   TRUNCATE uses minimal transaction log space.

**Transaction Log & Rollback**

*   **TRUNCATE Logging**
> [!NOTE]
> TRUNCATE uses minimal logging - only page deallocations are logged.
*   Can be rolled back if executed within a transaction.
*   However, once committed, cannot be recovered through transaction log.
*   Uses fewer system resources and locks.

*   **DELETE Logging**
> [!CAUTION]
> DELETE fully logs every individual row removal.
*   Fully supports rollback within transactions.
*   Transaction log can grow significantly with large deletions.
*   Each row deletion is individually recorded.

**Identity Column Behavior**

*   **TRUNCATE Reset**
> [!IMPORTANT]
> TRUNCATE resets identity columns to their seed value.
*   After TRUNCATE, next identity value starts from the beginning.
*   Example: Identity resets from 1000 back to 1.

*   **DELETE Preserves**
> [!NOTE]
> DELETE does not reset identity columns.
*   After DELETE, identity continues from last value.
*   Example: After deleting row 1000, next identity is 1001.

**SQL Examples**

*   **TRUNCATE Syntax**
```sql
-- Removes all rows, resets identity, fast
TRUNCATE TABLE Employees;

-- Can be rolled back in transaction
BEGIN TRANSACTION
TRUNCATE TABLE Employees;
ROLLBACK; -- Data restored
```

*   **DELETE Syntax**
```sql
-- Removes all rows, preserves identity, slow
DELETE FROM Employees;

-- Conditional deletion supported
DELETE FROM Employees WHERE Department = 'HR';

-- Rollback fully supported
BEGIN TRANSACTION
DELETE FROM Employees;
ROLLBACK; -- All data restored
```

**Constraints & Triggers**

*   **TRUNCATE Limitations**
> [!CAUTION]
> TRUNCATE cannot be used on tables with FOREIGN KEY constraints.
*   Will fail if any foreign keys reference the table.
*   Does not fire DELETE triggers.
*   Requires higher permissions (typically DDL rights).

*   **DELETE Flexibility**
> [!TIP]
> DELETE works with foreign keys and fires triggers.
*   Honors foreign key constraints with CASCADE options.
*   Fires any defined DELETE triggers.
*   Standard DML permissions required.

**Use Case Scenarios**

*   **Use TRUNCATE When:**
*   Removing all rows from a large table quickly.
*   You need to reset identity counters.
*   No foreign key constraints block the operation.
*   Performance is critical and triggers aren't needed.

*   **Use DELETE When:**
*   Removing specific rows with WHERE conditions.
*   Tables have foreign key constraints.
*   You need DELETE triggers to execute.
*   You want to maintain identity sequence.
*   Working within complex transactional logic.

**Recovery Considerations**

*   **TRUNCATE Recovery**
> [!WARNING]
> TRUNCATE operations are harder to recover from accidentally.
*   Not fully logged, so point-in-time recovery is limited.
*   Requires database backups or other recovery methods.

*   **DELETE Recovery**
*   Fully logged, so can be recovered via transaction log.
*   Supports point-in-time recovery scenarios.
*   Easier to undo accidental deletions.

**Summary Table**

| Aspect | TRUNCATE | DELETE |
|--------|----------|---------|
| **Operation Type** | DDL | DML |
| **Speed** | Very Fast | Slow |
| **Logging** | Minimal | Full |
| **Identity Reset** | Yes | No |
| **WHERE Clause** | No | Yes |
| **Triggers Fired** | No | Yes |
| **Foreign Keys** | Blocked | Allowed |
| **Rollback** | Supported | Supported |
