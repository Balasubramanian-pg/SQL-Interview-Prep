Let me explain different types of joins using the Superstore dataset with practical examples.

## 1. INNER JOIN - Finding Lost Revenue from Returns

```SQL
-- Total revenue lost from returned orders (city-wise)
SELECT
    sor.city,
    SUM(sor.sales) AS lost_revenue
FROM Superstore_orders AS sor
INNER JOIN returns ru ON sor.order_ID = ru.Order_ID
GROUP BY sor.city
ORDER BY lost_revenue DESC;
```

**Key Points**:

- Only matches records that exist in both tables
- Shows cities with actual returns
- Groups by city and sums the lost sales

## 2. LEFT JOIN - Finding Non-Returned Orders

```SQL
-- Orders that were NOT returned
SELECT
    sor.order_id,
    sor.sales
FROM Superstore_orders AS sor
LEFT JOIN returns ru ON sor.order_ID = ru.Order_ID
WHERE ru.Order_ID IS NULL;
```

**Key Points**:

- Returns all orders from Superstore_orders table
- Only includes orders that don't have a match in returns table
- The `WHERE ru.Order_ID IS NULL` condition filters for non-returns

## 3. RIGHT JOIN - Finding Returns Without Order Info

```SQL
-- Returns that don't have matching order records
SELECT
    ru.order_id AS return_id,
    sor.order_id AS original_order_id,
    sor.sales
FROM Superstore_orders AS sor
RIGHT JOIN returns ru ON sor.order_ID = ru.Order_ID
WHERE sor.order_id IS NULL;
```

**Key Points**:

- Returns all records from returns table
- Only shows returns that don't match any orders
- Useful for data quality checks (orphaned returns)

## 4. FULL OUTER JOIN - Comprehensive View

```SQL
-- All orders and returns with matches where they exist
SELECT
    COALESCE(sor.order_id, ru.order_id) AS order_id,
    sor.sales,
    CASE WHEN ru.order_id IS NULL THEN 'No' ELSE 'Yes' END AS was_returned
FROM Superstore_orders AS sor
FULL OUTER JOIN returns ru ON sor.order_ID = ru.Order_ID;
```

**Key Points**:

- Combines all records from both tables
- `COALESCE` returns first non-null value
- Shows both returned and non-returned orders

## 5. CROSS JOIN - All Possible Combinations (Cartesian Product)

```SQL
-- Not typically useful for this scenario but included for completeness
SELECT
    sor.order_id,
    ru.order_id AS return_id
FROM Superstore_orders AS sor
CROSS JOIN returns ru;
```

**Note**: This creates a row for every possible combination of orders and returns, which is rarely what you want in business analysis.

## Practical Join Applications

1. **Return Rate Analysis**:

```SQL
SELECT
    sor.category,
    COUNT(DISTINCT sor.order_id) AS total_orders,
    COUNT(DISTINCT ru.order_id) AS returned_orders,
    ROUND(100.0 * COUNT(DISTINCT ru.order_id) / COUNT(DISTINCT sor.order_id), 2) AS return_rate
FROM Superstore_orders sor
LEFT JOIN returns ru ON sor.order_id = ru.order_id
GROUP BY sor.category
ORDER BY return_rate DESC;
```

1. **Customer Return Behavior**:

```SQL
SELECT
    sor.customer_name,
    SUM(sor.sales) AS total_spend,
    SUM(CASE WHEN ru.order_id IS NOT NULL THEN sor.sales ELSE 0 END) AS returned_amount,
    COUNT(DISTINCT CASE WHEN ru.order_id IS NOT NULL THEN sor.order_id END) AS return_count
FROM Superstore_orders sor
LEFT JOIN returns ru ON sor.order_id = ru.order_id
GROUP BY sor.customer_name
HAVING COUNT(DISTINCT CASE WHEN ru.order_id IS NOT NULL THEN sor.order_id END) > 0
ORDER BY returned_amount DESC;
```

1. **Regional Return Patterns**:

```SQL
SELECT
    sor.region,
    sor.category,
    ROUND(100.0 * COUNT(DISTINCT ru.order_id) / COUNT(DISTINCT sor.order_id), 2) AS return_rate
FROM Superstore_orders sor
LEFT JOIN returns ru ON sor.order_id = ru.order_id
GROUP BY sor.region, sor.category
ORDER BY sor.region, return_rate DESC;
```
