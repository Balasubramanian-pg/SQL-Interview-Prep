There are several methods to split concatenated strings into separate columns. Let me explain both the `CHARINDEX` approach and the `STRING_SPLIT` function approach with your examples.

## Method 1: Using CHARINDEX (Works in Most SQL Variants)

```SQL
-- Find comma position
SELECT name, CHARINDEX(',', name) AS position_of_comma FROM empy2;

-- Extract last name (including comma)
SELECT name, LEFT(name, CHARINDEX(',', name)) AS last_name FROM empy2;

-- Extract clean last name and first name
SELECT
    name,
    LEFT(name, CHARINDEX(',', name) - 1) AS last_name,
    LTRIM(RIGHT(name, LEN(name) - CHARINDEX(',', name))) AS first_name
FROM empy2;
```

**Key Points**:

- `CHARINDEX` finds the position of the comma
- `LEFT` extracts characters from the start
- `RIGHT` extracts characters from the end
- `LTRIM` removes leading spaces from the first name
- Subtract 1 from comma position to exclude the comma itself

## Method 2: Using STRING_SPLIT (SQL Server 2016+)

```SQL
-- Basic STRING_SPLIT demonstration
SELECT value FROM STRING_SPLIT('Owens, Adams', ',');

-- Split all names with row numbering
SELECT
    emp_id,
    value,
    ROW_NUMBER() OVER(PARTITION BY emp_id ORDER BY emp_id) AS row_num
FROM empy2
CROSS APPLY STRING_SPLIT(name, ',');
```

**Pivoting the Results**:

```SQL
WITH name_cte AS (
    SELECT
        emp_id,
        value,
        ROW_NUMBER() OVER(PARTITION BY emp_id ORDER BY emp_id) AS row_num
    FROM empy2
    CROSS APPLY STRING_SPLIT(name, ',')
)
SELECT
    emp_id,
    [1] AS last_name,
    [2] AS first_name
FROM name_cte
PIVOT (
    MAX(value)
    FOR row_num IN ([1], [2])
) AS pvt;
```

## Important Notes:

1. **STRING_SPLIT Limitations**:
    - Doesn't guarantee order of returned values
    - Requires SQL Server 2016 or later
    - Works better with PIVOT when combined with ROW_NUMBER()
2. **CHARINDEX Approach**:
    - More reliable for fixed-format strings
    - Works in older SQL Server versions and other RDBMS
    - Requires exact knowledge of the delimiter position
3. **Alternative for Complex Splits**:  
    For more complex string splitting scenarios, consider creating a custom function.  
    

## Best Practice Recommendation:

For production environments with SQL Server 2016+, I recommend the STRING_SPLIT with PIVOT approach as it's more readable and maintainable. However, the CHARINDEX method is more portable across different SQL implementations.
