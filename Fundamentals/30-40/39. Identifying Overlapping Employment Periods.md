## **SQL Query**

```SQL
SELECT
    emp.firstname,
    emp.lastname,
    emp.title,
    emp.departmentname,
    emp.phone,
    emp.startdate,
    emp.enddate
FROM dbo.employee emp, dbo.employee emp1
WHERE emp.firstname = emp1.firstname
AND emp.lastname = emp1.lastname
AND emp.startdate < emp1.startdate
AND emp.enddate > emp1.startdate;
```

## **Explanation**

1. **Self-Join on Employee Table**
    - The query joins the `employee` table with itself (`emp` and `emp1`) to compare records of the same employee across different employment periods.
2. **Identifying Employees with Overlapping Employment Periods**
    - `emp.firstname = emp1.firstname` AND `emp.lastname = emp1.lastname`: Ensures that only records for the same individual are compared.
    - `emp.startdate < emp1.startdate`: Checks that the first employment period began before the second.
    - `emp.enddate > emp1.startdate`: Ensures that the first employment period was still active when the second employment period began.

## **Execution Steps**

1. Query retrieves employees who have overlapping employment periods.
2. Uses a **self-join** to compare each employee's records with their other employment records.

## **Expected Output** (Example)

|   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|
|Firstname|Lastname|Title|Department|Phone|StartDate|EndDate|
|John|Doe|Manager|Sales|123-456-789|2015-01-01|2020-06-30|
|John|Doe|Senior Mgr|Marketing|123-456-789|2019-07-01|2025-12-31|

## **Key Benefits**

- **Detects overlapping employment records** for rehired employees or internal transfers.
- **Ensures data consistency** by identifying potential data-entry issues.
- **Useful for HR audits** to track employment history.

## **Optimization Tip**

- Replace the **comma join (**`**FROM dbo.employee emp, dbo.employee emp1**`**)** with an **explicit JOIN** for better readability and performance:
    
    ```SQL
    FROM dbo.employee emp
    INNER JOIN dbo.employee emp1
    ON emp.firstname = emp1.firstname
    AND emp.lastname = emp1.lastname
    ```
