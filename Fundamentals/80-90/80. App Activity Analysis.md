## Q1: Daily Active Users

```SQL
SELECT
    event_date,
    COUNT(DISTINCT user_id) AS daily_active_users
FROM activityy
GROUP BY event_date
ORDER BY event_date;
```

## Q2: Weekly Active Users (SQL Server)

```SQL
SELECT
    DATEPART(week, event_date) AS week_number,
    COUNT(DISTINCT user_id) AS weekly_active_users
FROM activityy
GROUP BY DATEPART(week, event_date)
ORDER BY week_number;
```

## Q3: Same-Day Install & Purchase Users

```SQL
SELECT
    event_date,
    COUNT(DISTINCT user_id) AS same_day_purchasers
FROM (
    SELECT
        user_id,
        event_date,
        COUNT(DISTINCT event_name) AS event_count
    FROM activityy
    GROUP BY user_id, event_date
    HAVING COUNT(DISTINCT event_name) = 2
) a
GROUP BY event_date
ORDER BY event_date;
```

## Q4: Country-Wise Paid User Percentage

```SQL
WITH country_users AS (
    SELECT
        CASE
            WHEN country IN ('India','USA') THEN country
            ELSE 'Others'
        END AS country_group,
        COUNT(DISTINCT user_id) AS user_count
    FROM activityy
    WHERE event_name = 'app-purchase'
    GROUP BY
        CASE
            WHEN country IN ('India','USA') THEN country
            ELSE 'Others'
        END
),
total_users AS (
    SELECT SUM(user_count) AS total FROM country_users
)
SELECT
    country_group,
    user_count,
    ROUND((user_count * 100.0 / total), 2) AS percentage
FROM country_users, total_users
ORDER BY percentage DESC;
```

## Q5: Next-Day Purchasers After Install

```SQL
WITH user_sequences AS (
    SELECT
        *,
        LAG(event_name) OVER(PARTITION BY user_id ORDER BY event_date) AS prev_event,
        LAG(event_date) OVER(PARTITION BY user_id ORDER BY event_date) AS prev_date
    FROM activityy
)
SELECT
    event_date,
    COUNT(DISTINCT user_id) AS next_day_purchasers
FROM user_sequences
WHERE
    event_name = 'app-purchase' AND
    prev_event = 'app-installed' AND
    DATEDIFF(day, prev_date, event_date) = 1
GROUP BY event_date
ORDER BY event_date;
```

## Key Insights

1. **Daily/Weekly Activity**:
    - Tracks user engagement trends over time
    - Helps identify peak usage periods
2. **Conversion Analysis**:
    - Same-day purchases show immediate conversion
    - Next-day purchases indicate thoughtful consideration
3. **Geographic Distribution**:
    - Reveals market penetration by country
    - Helps allocate marketing resources effectively
4. **User Journey**:
    - Tracks the path from installation to purchase
    - Identifies optimal timeframes for promotions

## Alternative Approach for Q5 (MySQL/PostgreSQL)

```SQL
WITH installs AS (
    SELECT user_id, event_date AS install_date
    FROM activityy
    WHERE event_name = 'app-installed'
),
purchases AS (
    SELECT user_id, event_date AS purchase_date
    FROM activityy
    WHERE event_name = 'app-purchase'
)
SELECT
    i.install_date,
    COUNT(DISTINCT p.user_id) AS next_day_purchasers
FROM installs i
JOIN purchases p ON
    i.user_id = p.user_id AND
    p.purchase_date = i.install_date + INTERVAL 1 DAY
GROUP BY i.install_date
ORDER BY i.install_date;
```
