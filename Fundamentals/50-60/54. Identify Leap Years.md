Here are two robust methods to determine if a year is a leap year in SQL:

## Method 1: Using Date Validation (SQL Server)

```SQL
DECLARE @year INT = 2024; -- Change this value to test different years

SELECT
    @year AS year_to_check,
    CASE
        WHEN ISDATE(CAST(@year AS CHAR(4)) + '0229') = 1
        THEN 'LEAP YEAR'
        ELSE 'NOT A LEAP YEAR'
    END AS leap_year_status;
```

**How it works**:

- Attempts to create February 29th for the given year
- Checks if it's a valid date (ISDATE returns 1 for valid dates)
- February 29th only exists in leap years

## Method 2: Using Mathematical Rules (Standard SQL)

```SQL
DECLARE @year INT = 2024; -- Change this value to test different years

SELECT
    @year AS year_to_check,
    CASE
        WHEN (@year % 4 = 0 AND @year % 100 <> 0) OR @year % 400 = 0
        THEN 'LEAP YEAR'
        ELSE 'NOT A LEAP YEAR'
    END AS leap_year_status;
```

**Leap Year Rules**:

1. Divisible by 4 (year % 4 = 0)
2. Not divisible by 100 (year % 100 â‰  0) **unless**
3. Also divisible by 400 (year % 400 = 0)

## Complete Solution with Test Cases

```SQL
-- Create a function for reusable leap year checking
CREATE FUNCTION dbo.IsLeapYear(@year INT)
RETURNS BIT
AS
BEGIN
    RETURN CASE
        WHEN (@year % 4 = 0 AND @year % 100 <> 0) OR @year % 400 = 0
        THEN 1
        ELSE 0
    END;
END;
GO

-- Test the function with various years
DECLARE @test_years TABLE (year INT);
INSERT INTO @test_years VALUES (1900), (2000), (2020), (2021), (2024), (2100);

SELECT
    year,
    dbo.IsLeapYear(year) AS is_leap_year,
    CASE
        WHEN dbo.IsLeapYear(year) = 1 THEN 'LEAP YEAR'
        ELSE 'NOT A LEAP YEAR'
    END AS leap_year_status
FROM @test_years;
```

## Key Differences Between Methods:

1. **Date Validation Method**:
    - SQL Server specific (uses ISDATE)
    - Simple but less portable
    - Relies on date functions rather than logic
2. **Mathematical Method**:
    - Works in all SQL dialects
    - Explicitly implements leap year rules
    - More flexible for other calculations

Choose Method 1 for quick checks in SQL Server, or Method 2 for cross-platform compatibility and when you need to understand the specific leap year rules.
