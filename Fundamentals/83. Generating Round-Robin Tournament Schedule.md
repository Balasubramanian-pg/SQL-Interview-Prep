## Problem Analysis

We need to create a match schedule where each country plays every other country exactly once (round-robin tournament format).

## Solution Approach

### 1. Basic Self-Join Approach

```SQL
SELECT
    a.countryname AS team1,
    b.countryname AS team2
FROM countries a
INNER JOIN countries b ON a.countryname < b.countryname;
```

**How it works**:

- The `a.countryname < b.countryname` condition ensures:
    - No country is paired with itself
    - Each unique pair appears only once (avoids both A vs B and B vs A)
- Uses alphabetical comparison to eliminate duplicates

### 2. Complete Solution with Sample Data

```SQL
-- Create table and insert sample data
CREATE TABLE countries (countryname varchar(20));
INSERT INTO countries VALUES
('NewZealand'), ('Australia'), ('England'), ('India'), ('SouthAfrica');

-- Generate match schedule
SELECT
    ROW_NUMBER() OVER(ORDER BY a.countryname, b.countryname) AS match_id,
    a.countryname AS home_team,
    b.countryname AS away_team,
    CONCAT(a.countryname, ' vs ', b.countryname) AS match_name
FROM countries a
INNER JOIN countries b ON a.countryname < b.countryname
ORDER BY a.countryname, b.countryname;
```

### 3. Enhanced Version with Match Dates

```SQL
WITH matches AS (
    SELECT
        a.countryname AS team1,
        b.countryname AS team2,
        ROW_NUMBER() OVER(ORDER BY a.countryname, b.countryname) AS match_num
    FROM countries a
    INNER JOIN countries b ON a.countryname < b.countryname
)
SELECT
    match_num,
    team1,
    team2,
    DATEADD(day, (match_num-1)*3, '2023-06-01') AS match_date
FROM matches
ORDER BY match_num;
```

## Key Features

1. **Avoids Duplicate Matches**:
    - The `<` comparison operator ensures each pair appears only once
    - More reliable than `!=` which would produce both A vs B and B vs A
2. **Scalable**:
    - Works for any number of teams (N teams produce NÃ—(N-1)/2 matches)
3. **Flexible**:
    - Can easily add columns for venue, time, etc.
    - Can be adapted for double round-robin (home and away matches)

## Example Output

For 5 countries, the output would be:

```Plain
match_id | home_team   | away_team    | match_name
---------+-------------+--------------+---------------------
1        | Australia   | England      | Australia vs England
2        | Australia   | India        | Australia vs India
3        | Australia   | NewZealand   | Australia vs NewZealand
4        | Australia   | SouthAfrica  | Australia vs SouthAfrica
5        | England     | India        | England vs India
6        | England     | NewZealand   | England vs NewZealand
7        | England     | SouthAfrica  | England vs SouthAfrica
8        | India       | NewZealand   | India vs NewZealand
9        | India       | SouthAfrica  | India vs SouthAfrica
10       | NewZealand  | SouthAfrica  | NewZealand vs SouthAfrica
```

## Alternative Approach (Using CROSS JOIN)

```SQL
SELECT
    a.countryname AS team1,
    b.countryname AS team2
FROM countries a
CROSS JOIN countries b
WHERE a.countryname < b.countryname;
```