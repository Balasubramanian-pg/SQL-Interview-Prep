Here's a comprehensive guide to the SQL queries you've presented, with corrections and improvements where needed:

## 1. Cities Not Starting/Ending with Vowels

```SQL
SELECT DISTINCT city
FROM employees
WHERE
    LOWER(SUBSTRING(city, 1, 1)) NOT IN ('a','e','i','o','u')
    AND LOWER(SUBSTRING(city, -1, 1)) NOT IN ('a','e','i','o','u');
```

**Improvement**: Used `LOWER()` to simplify vowel checking (case-insensitive)

## 2. Create Table Structure from Existing Table

```SQL
SELECT * INTO new_table
FROM old_table
WHERE 1=0;
```

**Note**: Works in SQL Server. For MySQL use:

```SQL
CREATE TABLE new_table LIKE old_table;
```

## 3. Check for Duplicate Emails

```SQL
SELECT email, COUNT(*) as count
FROM person
GROUP BY email
HAVING COUNT(*) > 1;
```

**Correction**: Added missing `COUNT(*)` in HAVING clause

## 4. Extract First Name from Full Name

```SQL
SELECT
    SUBSTRING(fullname, 1, CHARINDEX(' ', fullname) - 1) AS first_name
FROM employee;
```

**Correction**: Fixed syntax (parentheses placement) and adjusted substring logic

## 5. Find Duplicate Records

```SQL
SELECT emp_id, dept, COUNT(*) as duplicate_count
FROM employee
GROUP BY emp_id, dept
HAVING COUNT(*) > 1;
```

**Improvement**: Added count column to show how many duplicates exist

## 6. Remove Duplicates (Keeping One)

```SQL
WITH duplicates AS (
    SELECT emp_id, ROW_NUMBER() OVER(PARTITION BY emp_id, dept ORDER BY emp_id) as rn
    FROM employee
)
DELETE FROM duplicates WHERE rn > 1;
```

**Improvement**: More reliable method that keeps one copy of each record

## 7. Increase Employee Income by 5%

```SQL
UPDATE employees
SET income = income * 1.05;
```

**Simplification**: More concise calculation

## 8. Employees Starting with 'A'

```SQL
SELECT first_name
FROM employee
WHERE first_name LIKE 'A%';
```

**Note**: For case-insensitive search:

```SQL
WHERE UPPER(first_name) LIKE 'A%';
```

## 9. Count Employees in Department 'ABC'

```SQL
SELECT COUNT(*) as employee_count
FROM employee
WHERE department_name = 'ABC';
```

**Correction**: Added missing `(*)` to COUNT function

## 10. Employees with 6-Letter Names Ending with 'A'

```SQL
SELECT *
FROM employees
WHERE first_name LIKE '_____A';
```

**Note**: 5 underscores + 'A' = 6 characters total

## 11. Employees with Salary Between Ranges

```SQL
SELECT *
FROM employee
WHERE salary BETWEEN 10000 AND 50000;
```

**Alternative**:

```SQL
WHERE salary >= 10000 AND salary <= 50000;
```

## 12. Common Records Between Tables

```SQL
SELECT * FROM table1
INTERSECT
SELECT * FROM table2;
```

**Note**: Requires same number/type of columns in both tables

## 13. Top N Records by Salary

```SQL
-- SQL Server
SELECT TOP 10 *
FROM employee
ORDER BY salary DESC;

-- MySQL/PostgreSQL
SELECT *
FROM employee
ORDER BY salary DESC
LIMIT 10;
```

## 14. Concatenate First and Last Names

```SQL
SELECT
    CONCAT(empfname, ' ', emplname) AS fullname,
    empfname AS first_name,
    emplname AS last_name
FROM employee;
```

**Improvement**: Added separate columns for first/last names along with fullname

## Additional Useful Queries

### 15. Find Employees with NULL Values

```SQL
SELECT *
FROM employee
WHERE email IS NULL OR department_id IS NULL;
```

### 16. Pagination Query

```SQL
-- SQL Server 2012+
SELECT *
FROM employee
ORDER BY hire_date
OFFSET 10 ROWS FETCH NEXT 5 ROWS ONLY;

-- MySQL
SELECT *
FROM employee
ORDER BY hire_date
LIMIT 10, 5;
```

### 17. Find Departments with Average Salary > Company Average

```SQL
WITH dept_avg AS (
    SELECT department_id, AVG(salary) as avg_salary
    FROM employee
    GROUP BY department_id
)
SELECT department_id, avg_salary
FROM dept_avg
WHERE avg_salary > (SELECT AVG(salary) FROM employee);
```