## Q1: First Login Date for Each Player

```SQL
SELECT
    player_id,
    MIN(event_date) AS first_login_date
FROM activity
GROUP BY player_id;
```

**Explanation**: This query finds the earliest login date for each player by grouping records by player_id and using the MIN() function on event_date.

## Q2: First Device Used by Each Player

```SQL
WITH first_logins AS (
    SELECT
        *,
        RANK() OVER(PARTITION BY player_id ORDER BY event_date) AS login_rank
    FROM activity
)
SELECT
    player_id,
    device_id,
    event_date AS first_login_date
FROM first_logins
WHERE login_rank = 1;
```

**Explanation**: This solution:

1. Uses a CTE to rank each player's logins by date
2. Filters to only include the first login (rank = 1)
3. Returns the player_id, device_id, and login date

## Q3: Cumulative Games Played by Date

```SQL
SELECT
    player_id,
    event_date,
    games_played,
    SUM(games_played) OVER(
        PARTITION BY player_id
        ORDER BY event_date
        ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS cumulative_games_played
FROM activity
ORDER BY player_id, event_date;
```

**Explanation**: This window function:

- Partitions data by player_id
- Orders by event_date
- Calculates a running sum of games_played
- The ROWS clause ensures proper cumulative calculation

## Q4: Fraction of Players Who Logged In the Day After First Login

```SQL
WITH first_logins AS (
    SELECT
        player_id,
        MIN(event_date) AS first_date
    FROM activity
    GROUP BY player_id
),
next_day_logins AS (
    SELECT
        COUNT(DISTINCT a.player_id) AS returning_players
    FROM activity a
    INNER JOIN first_logins f ON a.player_id = f.player_id
    WHERE DATEDIFF(day, f.first_date, a.event_date) = 1
),
total_players AS (
    SELECT COUNT(DISTINCT player_id) AS total
    FROM activity
)
SELECT
    ROUND(
        (SELECT returning_players FROM next_day_logins) * 1.0 /
        (SELECT total FROM total_players),
        2
    ) AS fraction_returning;
```

**Explanation**:

1. `first_logins` identifies each player's first login date
2. `next_day_logins` counts players who logged in exactly 1 day after their first login
3. `total_players` counts all distinct players
4. The final query calculates the fraction and rounds to 2 decimal places

**Note**: The 1.0 multiplication ensures decimal division rather than integer division.
