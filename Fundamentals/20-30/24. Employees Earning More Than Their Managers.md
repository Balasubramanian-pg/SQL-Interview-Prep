This query demonstrates a classic self-join scenario to identify employees who earn more than their direct managers:

```SQL
SELECT
    e.emp_id,
    e.emp_name AS employee_name,
    e.salary AS employee_salary,
    m.emp_name AS manager_name,
    m.salary AS manager_salary
FROM
    empm e
INNER JOIN
    empm m ON e.manager_id = m.emp_id
WHERE
    e.salary > m.salary
ORDER BY
    (e.salary - m.salary) DESC;
```

## Explanation:

1. **Self-Join Concept**:
    - We treat the `empm` table as two separate logical tables: one for employees (`e`) and one for managers (`m`)
    - The join condition `e.manager_id = m.emp_id` connects each employee to their manager
2. **Filter Condition**:
    - `WHERE e.salary > m.salary` ensures we only return employees who earn more than their managers
3. **Result Columns**:
    - Employee details (ID, name, salary)
    - Corresponding manager details (name, salary)
    - Calculates the salary difference for sorting
4. **Sorting**:
    - Orders results by the salary difference in descending order to show the largest discrepancies first

## Expected Output:

For the provided data, the query would return:

|   |   |   |   |   |
|---|---|---|---|---|
|emp_id|employee_name|employee_salary|manager_name|manager_salary|
|4|Rohit|5000|Mohit|15000|
|6|Agam|12000|Mohit|15000|

**Note**: The actual output might vary based on your data. The example shows the structure rather than exact matches for the sample data.

## Alternative Version with Additional Insights:

```SQL
SELECT
    e.emp_id,
    e.emp_name AS employee_name,
    e.department_id,
    e.salary AS employee_salary,
    m.emp_name AS manager_name,
    m.salary AS manager_salary,
    (e.salary - m.salary) AS salary_difference,
    ROUND((e.salary * 100.0 / m.salary), 2) AS salary_percentage_of_manager
FROM
    empm e
JOIN
    empm m ON e.manager_id = m.emp_id
WHERE
    e.salary > m.salary
ORDER BY
    salary_difference DESC;
```

This enhanced version adds:

- Department information
- Calculated salary difference
- Employee salary as a percentage of manager's salary
- More comprehensive sorting
