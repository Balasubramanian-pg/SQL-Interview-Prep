## Fundamental Differences

|   |   |   |
|---|---|---|
|Feature|WHERE Clause|HAVING Clause|
|Purpose|Filters individual rows|Filters aggregated/grouped data|
|Execution|Applied before grouping|Applied after grouping|
|Usage|With or without GROUP BY|Only with GROUP BY|
|Functions|Can't use aggregate functions|Can use aggregate functions|
|Performance|More efficient (filters early)|Less efficient (filters later)|

## Examples Explained

### 1. Basic WHERE Clause

```SQL
SELECT * FROM emp WHERE salary > 10000;
```

- Filters **individual rows** before any grouping
- Processes row-by-row
- Cannot use aggregate functions like AVG(), SUM() here

### 2. Basic HAVING Clause

```SQL
SELECT department_id, AVG(salary)
FROM emp
GROUP BY department_id
HAVING AVG(salary) > 9500;
```

- Filters **grouped results** after aggregation
- Can use aggregate functions (AVG in this case)
- Only departments with average salary > 9500 are returned

### 3. Combined WHERE and HAVING

```SQL
SELECT department_id, AVG(salary)
FROM emp
WHERE salary > 10000  -- First filter individual rows
GROUP BY department_id
HAVING AVG(salary) > 12000;  -- Then filter groups
```

Execution order:

1. WHERE filters employees with salary > 10000
2. GROUP BY organizes remaining employees by department
3. HAVING filters departments where the average > 12000

## When to Use Each

**Use WHERE when:**

- Filtering raw data before any calculations
- Your condition doesn't involve aggregate functions
- You want better query performance

**Use HAVING when:**

- You need to filter based on aggregated values
- Your condition uses functions like SUM, AVG, COUNT
- You've already used GROUP BY

## Performance Implications

- **WHERE is more efficient**: It reduces the dataset before grouping
- **HAVING is less efficient**: It processes all data first, then filters
- **Best practice**: Use WHERE to filter first whenever possible

## Advanced Example

```SQL
-- Find departments with more than 5 employees earning over 50,000
SELECT
    department_id,
    COUNT(*) AS high_earners,
    AVG(salary) AS avg_salary
FROM emp
WHERE salary > 50000          -- First filter individuals
GROUP BY department_id
HAVING COUNT(*) > 5           -- Then filter groups
ORDER BY avg_salary DESC;
```

This query demonstrates the optimal use of both clauses for efficient data analysis.