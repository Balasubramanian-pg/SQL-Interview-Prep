  

### Department-wise Salary Statistics

```SQL
SELECT
    department_id,
    COUNT(*) AS employee_count,
    AVG(salary) AS avg_salary,
    MAX(salary) AS max_salary,
    MIN(salary) AS min_salary,
    SUM(salary) AS total_salary_budget
FROM emp
GROUP BY department_id
ORDER BY avg_salary DESC;
```

### Employee Ranking Within Departments

```SQL
SELECT
    emp_id,
    emp_name,
    department_id,
    salary,
    RANK() OVER(PARTITION BY department_id ORDER BY salary DESC) AS dept_salary_rank,
    ROUND(salary * 100.0 / SUM(salary) OVER(PARTITION BY department_id), 2) AS salary_percentage_of_dept
FROM emp
ORDER BY department_id, salary DESC;
```

### Salary Comparison with Department Averages

```SQL
WITH dept_stats AS (
    SELECT
        department_id,
        AVG(salary) AS avg_salary
    FROM emp
    GROUP BY department_id
)
SELECT
    e.emp_id,
    e.emp_name,
    e.department_id,
    e.salary,
    d.avg_salary AS department_avg,
    CASE
        WHEN e.salary > d.avg_salary THEN 'Above Average'
        WHEN e.salary < d.avg_salary THEN 'Below Average'
        ELSE 'At Average'
    END AS salary_status
FROM emp e
JOIN dept_stats d ON e.department_id = d.department_id
ORDER BY e.department_id, e.salary DESC;
```

### Finding Salary Gaps

```SQL
SELECT
    department_id,
    MAX(salary) - MIN(salary) AS salary_range,
    MAX(salary) - AVG(salary) AS max_above_avg,
    AVG(salary) - MIN(salary) AS min_below_avg
FROM emp
GROUP BY department_id;
```

## Key Techniques Used:

1. **UNION ALL** - Combined team performances in cricket analysis
2. **CASE statements** - Calculated win/loss flags
3. **Window functions (RANK, SUM OVER)** - For relative salary analysis
4. **CTEs (WITH clauses)** - For intermediate result sets
5. **GROUP BY aggregations** - For department-level statistics

These queries provide comprehensive insights into both cricket tournament standings and employee compensation distribution patterns.