## Problem Analysis

We need to identify all employees who:

1. Were promoted (designation changed)
2. Resigned (present in 2020 but not 2021)
3. Are new hires (present in 2021 but not 2020)

## Complete Solution

```SQL
SELECT
    ISNULL(e20.emp_id, e21.emp_id) AS emp_id,
    CASE
        WHEN e20.designation IS NULL THEN 'New Hire'
        WHEN e21.designation IS NULL THEN 'Resigned'
        WHEN e20.designation != e21.designation THEN 'Promoted'
        ELSE 'No Change'
    END AS status_change,
    e20.designation AS 2020_designation,
    e21.designation AS 2021_designation
FROM emp_2020 e20
FULL OUTER JOIN emp_2021 e21 ON e21.emp_id = e20.emp_id
WHERE
    ISNULL(e20.designation, 'xxx') != ISNULL(e21.designation, 'yyy')
    OR e20.emp_id IS NULL
    OR e21.emp_id IS NULL;
```

## How This Works

1. **FULL OUTER JOIN** captures all employees from both years
2. **ISNULL()** handles NULL values for proper comparison
3. **CASE statement** categorizes each employee:
    - `New Hire`: Only in 2021 table
    - `Resigned`: Only in 2020 table
    - `Promoted`: Different designations in both years
    - `No Change`: Same designation (filtered out)
4. **WHERE clause** ensures we only see changed statuses

## Expected Output

```Plain
emp_id | status_change | 2020_designation    | 2021_designation
-------+--------------+---------------------+-----------------
1      | Promoted     | Trainee             | Developer
3      | Promoted     | Senior Developer    | Manager
4      | Resigned     | Manager             | NULL
5      | New Hire     | NULL                | Trainee
```

## Alternative Approach (More Readable)

```SQL
WITH employee_changes AS (
    SELECT
        COALESCE(e20.emp_id, e21.emp_id) AS emp_id,
        e20.designation AS old_designation,
        e21.designation AS new_designation,
        CASE
            WHEN e20.emp_id IS NULL THEN 'New Hire'
            WHEN e21.emp_id IS NULL THEN 'Resigned'
            WHEN e20.designation != e21.designation THEN 'Promoted'
            ELSE 'No Change'
        END AS status
    FROM emp_2020 e20
    FULL OUTER JOIN emp_2021 e21 ON e20.emp_id = e21.emp_id
)
SELECT
    emp_id,
    status AS status_change,
    old_designation AS 2020_designation,
    new_designation AS 2021_designation
FROM employee_changes
WHERE status != 'No Change';
```

## Key Insights

1. **FULL OUTER JOIN** is essential to see all employees from both years
2. **NULL handling** is critical when comparing across years
3. **CASE statement** provides clear categorization of changes
4. The solution handles all edge cases:
    - Employees who left
    - New joiners
    - Promotions
    - Employees with no changes (filtered out)
