## Pattern 7: Moving Averages

**Last 3 Rows Average:**
```sql
SELECT 
    date,
    value,
    AVG(value) OVER(
        ORDER BY date
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) as moving_avg_3
FROM metrics
```

**Centered Moving Average (1 before, current, 1 after):**
```sql
SELECT 
    date,
    value,
    AVG(value) OVER(
        ORDER BY date
        ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING
    ) as centered_avg
FROM metrics
```

**Moving Average Per Group:**
```sql
SELECT 
    product_id,
    sale_date,
    quantity,
    AVG(quantity) OVER(
        PARTITION BY product_id
        ORDER BY sale_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) as weekly_avg
FROM sales
```

