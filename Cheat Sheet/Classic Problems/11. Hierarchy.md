## Pattern 11: Recursive CTE (Hierarchy Depth)

**Find All Subordinates Under a Manager:**
```sql
WITH RECURSIVE subordinates AS (
    -- Base case: direct reports
    SELECT employee_id, employee_name, manager_id, 1 as level
    FROM employees
    WHERE manager_id = 5  -- Starting manager
    
    UNION ALL
    
    -- Recursive case: reports of reports
    SELECT e.employee_id, e.employee_name, e.manager_id, s.level + 1
    FROM employees e
    INNER JOIN subordinates s ON e.manager_id = s.employee_id
)
SELECT * FROM subordinates
```

**Full Org Chart with Depth:**
```sql
WITH RECURSIVE org_chart AS (
    -- Base: top-level (CEO)
    SELECT employee_id, employee_name, manager_id, 1 as level,
           CAST(employee_name AS VARCHAR(1000)) as path
    FROM employees
    WHERE manager_id IS NULL
    
    UNION ALL
    
    -- Recursive: add children
    SELECT e.employee_id, e.employee_name, e.manager_id, oc.level + 1,
           CAST(oc.path || ' > ' || e.employee_name AS VARCHAR(1000))
    FROM employees e
    INNER JOIN org_chart oc ON e.manager_id = oc.employee_id
)
SELECT * FROM org_chart ORDER BY path
```
