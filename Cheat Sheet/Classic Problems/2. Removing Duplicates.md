## Pattern 2: Removing Duplicates

**Keep First Occurrence (by ID):**
```sql
-- Using ROW_NUMBER (most common)
DELETE FROM users
WHERE id IN (
    SELECT id
    FROM (
        SELECT id, ROW_NUMBER() OVER(PARTITION BY email ORDER BY id) as rn
        FROM users
    ) sub
    WHERE rn > 1
)

-- Or SELECT to see what would be kept
SELECT *
FROM (
    SELECT *, ROW_NUMBER() OVER(PARTITION BY email ORDER BY id) as rn
    FROM users
) sub
WHERE rn = 1
```

**Keep Most Recent (by date):**
```sql
WITH ranked AS (
    SELECT *,
           ROW_NUMBER() OVER(PARTITION BY email ORDER BY created_at DESC) as rn
    FROM users
)
SELECT * FROM ranked WHERE rn = 1
```

**Interview Trick:** Mention that `DELETE` with subquery may need a temp table in some databases (like MySQL).
5. **"For removing duplicates, I'd check if we can use DISTINCT or if we need ROW_NUMBER with DELETE"** (shows you think about multiple approaches)

6. **"Recursive CTEs can hit max recursion limitsâ€”I'd check if we need to set recursion depth"** (shows production awareness)
