## Pattern 5: Top N Per Group

**Top 3 Salaries Per Department:**
```sql
-- Method 1: ROW_NUMBER (one per rank)
SELECT *
FROM (
    SELECT 
        dept_id,
        employee_name,
        salary,
        ROW_NUMBER() OVER(PARTITION BY dept_id ORDER BY salary DESC) as rn
    FROM employees
) ranked
WHERE rn <= 3

-- Method 2: DENSE_RANK (includes ties)
SELECT *
FROM (
    SELECT 
        dept_id,
        employee_name,
        salary,
        DENSE_RANK() OVER(PARTITION BY dept_id ORDER BY salary DESC) as rnk
    FROM employees
) ranked
WHERE rnk <= 3
```

**Latest Record Per Customer:**
```sql
SELECT *
FROM (
    SELECT *,
           ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY order_date DESC) as rn
    FROM orders
) latest
WHERE rn = 1
```

