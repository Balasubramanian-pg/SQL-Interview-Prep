## Pattern 9: First/Last Value in Group

**First and Last Salary Per Department:**
```sql
SELECT DISTINCT
    dept_id,
    FIRST_VALUE(salary) OVER(
        PARTITION BY dept_id 
        ORDER BY hire_date
    ) as first_hire_salary,
    LAST_VALUE(salary) OVER(
        PARTITION BY dept_id 
        ORDER BY hire_date
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) as last_hire_salary
FROM employees
```

**Interview Trap:** `LAST_VALUE` needs `ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING` or it only looks at current row!
