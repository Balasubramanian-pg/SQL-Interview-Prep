# Identifying "Power Creators"

## 1. Overview
> [!NOTE]
> This document analyzes a SQL query designed to answer the business question: **"Which individuals on the platform are 'power creators', defined as having more followers on their personal profile than their employer's company page has?"**

## 2. Table Schema
The query joins two tables, `personal_profiles` and `company_pages`. A plausible schema is as follows.

### 2.1. `personal_profiles` Table
Stores information about each individual user's profile.
```sql
CREATE TABLE personal_profiles (
    profile_id   INT PRIMARY KEY,
    full_name    VARCHAR(255) NOT NULL,
    employer_id  INT,                    -- Foreign key to the company_pages table
    followers    INT DEFAULT 0           -- The number of followers for the personal profile
);
```

### 2.2. `company_pages` Table
Stores information about each company's official page.
```sql
CREATE TABLE company_pages (
    company_id   INT PRIMARY KEY,
    company_name VARCHAR(255) NOT NULL,
    industry     VARCHAR(100),
    followers    INT DEFAULT 0           -- The number of followers for the company page
);
```
> [!TIP]
> To ensure data integrity, a foreign key constraint should be established to formalize the relationship between an employee and their employer.
> ```sql
> ALTER TABLE personal_profiles
> ADD CONSTRAINT fk_employer
> FOREIGN KEY (employer_id) REFERENCES company_pages(company_id);
> ```

## 3. Method 1: `INNER JOIN` with Direct Comparison
This is the most common, readable, and generally efficient way to solve this problem.

### 3.1. SQL Query
```sql
SELECT
    p.profile_id
FROM
    personal_profiles AS p
INNER JOIN
    company_pages AS c ON p.employer_id = c.company_id
WHERE
    p.followers > c.followers
ORDER BY
    p.profile_id ASC;
```

### 3.2. Explanation
The query finds "power creators" by first combining employee and company data and then filtering the result.
*   **`FROM personal_profiles ... INNER JOIN company_pages ...`**: This combines rows from `personal_profiles` (`p`) and `company_pages` (`c`) where the `employer_id` matches the `company_id`.
> [!IMPORTANT]
> The `INNER JOIN` is crucial here. It automatically filters out any personal profiles that do not have a valid, matching `employer_id` in the `company_pages` table, ensuring we only compare employees to their actual companies.
*   **`WHERE p.followers > c.followers`**: This clause filters the combined rows, keeping only those where the personal follower count (`p.followers`) is strictly greater than the company follower count (`c.followers`).
*   **`SELECT p.profile_id`**: From the final filtered list, this selects only the `profile_id`.
*   **`ORDER BY p.profile_id ASC`**: This sorts the resulting list of IDs in ascending order for a clean, predictable output.

## 4. Method 2: Correlated Subquery
This alternative method uses a subquery in the `WHERE` clause to fetch the company's follower count for each profile being evaluated.

### 4.1. SQL Query
```sql
SELECT
    p.profile_id
FROM
    personal_profiles AS p
WHERE
    p.employer_id IS NOT NULL AND
    p.followers > (
        SELECT
            c.followers
        FROM
            company_pages AS c
        WHERE
            c.company_id = p.employer_id
    )
ORDER BY
    p.profile_id ASC;
```

### 4.2. Explanation
This method achieves the same result by evaluating each person's profile one by one and looking up their company's data as needed.
*   **`FROM personal_profiles AS p`**: The outer query iterates through each row in the `personal_profiles` table.
*   **`WHERE p.employer_id IS NOT NULL AND ...`**: We first ensure the employee has a listed employer to avoid errors or unexpected behavior in the subquery.
*   **The Subquery**:
    > [!NOTE]
    > This is a **correlated subquery** because its execution depends on the data from the outer query (specifically, `p.employer_id`). It runs once for each row processed by the outer query.
    *   The inner query `(SELECT c.followers ...)` fetches the `followers` count from the `company_pages` table for the company that matches the *current* employee's `employer_id`.
    *   The outer query then compares the person's follower count (`p.followers`) to the single value returned by this subquery.
*   If the condition is true, the `profile_id` is included in the final result set.

## 5. Method Comparison
> [!TIP]
> The **`JOIN` method (Method 1)** is generally preferred. It is often more declarative, easier to read, and gives the database's query optimizer more flexibility to create an efficient execution plan.
>
> In most modern database systems, the optimizer is intelligent enough to rewrite a correlated subquery into a `JOIN` internally, so the performance of both methods will likely be identical. However, the `JOIN` syntax is more explicit and widely considered a best practice.
